/*
 Copyright (c) 2003-2014, CKSource - Frederico Knabben. All rights reserved.
 For licensing, see LICENSE.md or http://ckeditor.com/license
*/
(function(){function t(a){return CKEDITOR.env.ie?a.$.clientWidth:parseInt(a.getComputedStyle("width"),10)}function o(a,g){var b=a.getComputedStyle("border-"+g+"-width"),c={thin:"0px",medium:"1px",thick:"2px"};0>b.indexOf("px")&&(b=b in c&&"none"!=a.getComputedStyle("border-style")?c[b]:0);return parseInt(b,10)}function w(a){var g=[],b=-1,c="rtl"==a.getComputedStyle("direction"),k;k=a.$.rows;for(var h=0,f,d,e,i=0,p=k.length;i<p;i++)e=k[i],f=e.cells.length,f>h&&(h=f,d=e);k=d;h=new CKEDITOR.dom.element(a.$.tBodies[0]);
f=h.getDocumentPosition();d=0;for(e=k.cells.length;d<e;d++){var i=new CKEDITOR.dom.element(k.cells[d]),p=k.cells[d+1]&&new CKEDITOR.dom.element(k.cells[d+1]),b=b+(i.$.colSpan||1),l,j,m=i.getDocumentPosition().x;c?j=m+o(i,"left"):l=m+i.$.offsetWidth-o(i,"right");p?(m=p.getDocumentPosition().x,c?l=m+p.$.offsetWidth-o(p,"right"):j=m+o(p,"left")):(m=a.getDocumentPosition().x,c?l=m:j=m+a.$.offsetWidth);i=Math.max(j-l,3);g.push({table:a,index:b,x:l,y:f.y,width:i,height:h.$.offsetHeight,rtl:c})}return g}
function u(a){(a.data||a).preventDefault()}function A(a){function g(){i=0;e.setOpacity(0);l&&b();var v=f.table;setTimeout(function(){v.removeCustomData("_cke_table_pillars")},0);d.removeListener("dragstart",u)}function b(){for(var v=f.rtl,a=v?m.length:x.length,b=0;b<a;b++){var c=x[b],d=m[b],e=f.table;CKEDITOR.tools.setTimeout(function(a,b,c,d,f,k){a&&a.setStyle("width",j(Math.max(b+k,0)));c&&c.setStyle("width",j(Math.max(d-k,0)));f&&e.setStyle("width",j(f+k*(v?-1:1)))},0,this,[c,c&&t(c),d,d&&t(d),
(!c||!d)&&t(e)+o(e,"left")+o(e,"right"),l])}}function c(a){u(a);for(var a=f.index,c=CKEDITOR.tools.buildTableMap(f.table),b=[],g=[],j=Number.MAX_VALUE,o=j,s=f.rtl,r=0,w=c.length;r<w;r++){var n=c[r],q=n[a+(s?1:0)],n=n[a+(s?0:1)],q=q&&new CKEDITOR.dom.element(q),n=n&&new CKEDITOR.dom.element(n);if(!q||!n||!q.equals(n))q&&(j=Math.min(j,t(q))),n&&(o=Math.min(o,t(n))),b.push(q),g.push(n)}x=b;m=g;y=f.x-j;z=f.x+o;e.setOpacity(0.5);p=parseInt(e.getStyle("left"),10);l=0;i=1;e.on("mousemove",h);d.on("dragstart",
u);d.on("mouseup",k,this)}function k(a){a.removeListener();g()}function h(a){r(a.data.getPageOffset().x)}var f,d,e,i,p,l,x,m,y,z;d=a.document;e=CKEDITOR.dom.element.createFromHtml('<div data-cke-temp=1 contenteditable=false unselectable=on style="position:absolute;cursor:col-resize;filter:alpha(opacity=0);opacity:0;padding:0;background-color:#004;background-image:none;border:0px none;z-index:10"></div>',d);a.on("destroy",function(){e.remove()});s||d.getDocumentElement().append(e);this.attachTo=function(a){i||
(s&&(d.getBody().append(e),l=0),f=a,e.setStyles({width:j(a.width),height:j(a.height),left:j(a.x),top:j(a.y)}),s&&e.setOpacity(0.25),e.on("mousedown",c,this),d.getBody().setStyle("cursor","col-resize"),e.show())};var r=this.move=function(a){if(!f)return 0;if(!i&&(a<f.x||a>f.x+f.width))return f=null,i=l=0,d.removeListener("mouseup",k),e.removeListener("mousedown",c),e.removeListener("mousemove",h),d.getBody().setStyle("cursor","auto"),s?e.remove():e.hide(),0;a-=Math.round(e.$.offsetWidth/2);if(i){if(a==
y||a==z)return 1;a=Math.max(a,y);a=Math.min(a,z);l=a-p}e.setStyle("left",j(a));return 1}}function r(a){var g=a.data.getTarget();if("mouseout"==a.name){if(!g.is("table"))return;for(var b=new CKEDITOR.dom.element(a.data.$.relatedTarget||a.data.$.toElement);b&&b.$&&!b.equals(g)&&!b.is("body");)b=b.getParent();if(!b||b.equals(g))return}g.getAscendant("table",1).removeCustomData("_cke_table_pillars");a.removeListener()}var j=CKEDITOR.tools.cssLength,s=CKEDITOR.env.ie&&(CKEDITOR.env.ie7Compat||CKEDITOR.env.quirks);
CKEDITOR.plugins.add("tableresize",{requires:"tabletools",init:function(a){a.on("contentDom",function(){var g,b=a.editable();b.attachListener(b.isInline()?b:a.document,"mousemove",function(c){var c=c.data,b=c.getPageOffset().x;if(g&&g.move(b))u(c);else{var c=c.getTarget(),h;if(c.is("table")||c.getAscendant("tbody",1)){h=c.getAscendant("table",1);if(!(c=h.getCustomData("_cke_table_pillars")))h.setCustomData("_cke_table_pillars",c=w(h)),h.on("mouseout",r),h.on("mousedown",r);a:{h=0;for(var f=c.length;h<
f;h++){var d=c[h];if(b>=d.x&&b<=d.x+d.width){b=d;break a}}b=null}b&&(!g&&(g=new A(a)),g.attachTo(b))}}})})}})})();